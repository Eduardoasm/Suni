{"version":3,"file":"user.service.js","sourceRoot":"/","sources":["components/user/user/user.service.ts"],"names":[],"mappings":";;;;AAOA,0DAA0B;AAC1B,6CAAsE;AACtE,0CAA+C;AAC/C,gEAA6D;AAC7D,oEAAoE;AAEpE,SAAsB,OAAO,CAC3B,MAA2B,EAC3B,UAAyC,EACzC,OAAoC;;QAEpC,OAAO,iBAAI,CAAC,OAAO,CAAC,MAAM,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;IAC1D,CAAC;CAAA;AAND,0BAMC;AAED,SAAsB,IAAI,CACxB,MAA2B,EAC3B,UAAyC,EACzC,OAAoC;;QAEpC,OAAO,iBAAI,CAAC,IAAI,CAAC,MAAM,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;IACvD,CAAC;CAAA;AAND,oBAMC;AAED,SAAsB,SAAS,CAC7B,MAA0B,EAC1B,MAA0B,EAC1B,OAAoC;;QAEpC,OAAO,iBAAI,CAAC,SAAS,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;IACxD,CAAC;CAAA;AAND,8BAMC;AAED,SAAsB,MAAM,CAAC,IAAW;;QACtC,OAAO,iBAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC3B,CAAC;CAAA;AAFD,wBAEC;AAED,SAAgB,gBAAgB,CAAC,SAAiB;IAChD,QAAQ,SAAS,EAAE;QACjB,KAAK,GAAG;YACN,OAAO,GAAG,CAAC;QACb,KAAK,GAAG;YACN,OAAO,GAAG,CAAC;QACb,KAAK,GAAG;YACN,OAAO,GAAG,CAAC;QACb,KAAK,GAAG;YACN,OAAO,GAAG,CAAC;QACb,KAAK,GAAG;YACN,OAAO,GAAG,CAAC;QACb;YACE,OAAO,KAAK,CAAC;KAChB;AACH,CAAC;AAfD,4CAeC;AAED,SAAgB,iBAAiB,CAAC,SAAiB;IACjD,QAAQ,SAAS,EAAE;QACjB,KAAK,OAAO;YACV,OAAO,OAAO,CAAC;QACjB,KAAK,YAAY;YACf,OAAO,YAAY,CAAC;QACtB;YACE,OAAO,OAAO,CAAC;KAClB;AACH,CAAC;AATD,8CASC;AAED,SAAsB,UAAU,CAC9B,IAAY,EACZ,OAAe,EACf,MAA2B,EAC3B,UAAyC,EACzC,OAAoC;;QAEpC,OAAO,IAAA,qBAAa,EAAC,IAAI,EAAE,OAAO,EAAE,iBAAI,EAAE,MAAM,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC;IACzE,CAAC;CAAA;AARD,gCAQC;AAED,SAAsB,OAAO,CAAC,KAAa;;;QACzC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,MAAM,IAAA,sBAAW,EAAC,KAAK,CAAC,CAAC;QAEhD,IAAI,CAAC,IAAI,EAAE;YACT,MAAM,IAAI,6BAAa,CAAC,gBAAgB,CAAC,CAAC;SAC3C;QAED,IAAI,IAAI,KAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,aAAa,CAAA,EAAE;YAC/B,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,MAAA,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,aAAa,0CAAE,MAAM,CAAC,WAAW,EAAE,CAAC;SACvE;QAED,OAAO,IAAI,CAAC;;CACb;AAZD,0BAYC;AAED,SAAsB,YAAY,CAAC,QAAgB;;QACjD,MAAM,MAAM,GAAG,MAAM,eAAK,CAAC,GAAG,CAC5B,GAAG,OAAO,CAAC,GAAG,CAAC,WAAW,SAAS,QAAQ,EAAE,EAC7C;YACE,OAAO,EAAE;gBACP,aAAa,EAAE,UAAU,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAE;aACxD;SACF,CACF,CAAC;QACF,OAAO,MAAM,CAAC;IAChB,CAAC;CAAA;AAVD,oCAUC","sourcesContent":["/* eslint-disable import/no-cycle */\nimport type {\n  FilterQuery,\n  ProjectionType,\n  QueryOptions,\n  UpdateQuery,\n} from 'mongoose';\nimport axios from 'axios';\nimport { DniTypeEnum, IUser, User, UserRoleEnum } from './user.model';\nimport { paginateModel } from '../../../utils';\nimport { NoSentryError } from '../../../utils/NoSentryError';\nimport { getUserInfo } from '../../../utils/walletService/userInfo';\n\nexport async function findOne(\n  filter?: FilterQuery<IUser>,\n  projection?: ProjectionType<IUser> | null,\n  options?: QueryOptions<IUser> | null\n) {\n  return User.findOne(filter, projection, options).exec();\n}\n\nexport async function find(\n  filter?: FilterQuery<IUser>,\n  projection?: ProjectionType<IUser> | null,\n  options?: QueryOptions<IUser> | null\n) {\n  return User.find(filter, projection, options).exec();\n}\n\nexport async function updateOne(\n  filter: FilterQuery<IUser>,\n  update: UpdateQuery<IUser>,\n  options?: QueryOptions<IUser> | null\n) {\n  return User.updateOne(filter, update, options).exec();\n}\n\nexport async function create(user: IUser) {\n  return User.create(user);\n}\n\nexport function translateDniType(candidate: string): DniTypeEnum {\n  switch (candidate) {\n    case 'V':\n      return 'V';\n    case 'E':\n      return 'E';\n    case 'J':\n      return 'J';\n    case 'G':\n      return 'G';\n    case 'P':\n      return 'P';\n    default:\n      return 'N/A';\n  }\n}\n\nexport function translateUserRole(candidate: string): UserRoleEnum {\n  switch (candidate) {\n    case 'admin':\n      return 'admin';\n    case 'superadmin':\n      return 'superadmin';\n    default:\n      return 'admin';\n  }\n}\n\nexport async function pagination(\n  page: number,\n  perPage: number,\n  filter?: FilterQuery<IUser>,\n  projection?: ProjectionType<IUser> | null,\n  options?: QueryOptions<IUser> | null\n) {\n  return paginateModel(page, perPage, User, filter, projection, options);\n}\n\nexport async function getUser(token: string) {\n  const { data: user } = await getUserInfo(token);\n\n  if (!user) {\n    throw new NoSentryError('Not user found');\n  }\n\n  if (user && user?.metamapStatus) {\n    user.metamapStatus.status = user?.metamapStatus?.status.toLowerCase();\n  }\n\n  return user;\n}\n\nexport async function getWAOClient(clientId: string) {\n  const client = await axios.get(\n    `${process.env.SERVICE_URL}/user/${clientId}`,\n    {\n      headers: {\n        Authorization: `Bearer ${process.env.TOKEN_ADMIN_SUNI}`,\n      },\n    }\n  );\n  return client;\n}\n"]}